<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDARS - Prediction Tool</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/prediction.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Tactical Atmosphere -->
    <div class="background-grid"></div>
    <div class="background-gradient"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="logo.png" alt="SDARS Logo" class="logo-image"
                    onerror="this.parentElement.classList.add('img-error')"><span class="logo-fallback">üõ∞Ô∏è</span>
                <div class="logo-text">
                    <h1>SDARS</h1>
                    <p>TACTICAL INTELLIGENCE HUB</p>
                </div>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">DASHBOARD</a></li>
                <li><a href="map.html" class="nav-link">STRATEGIC MAP</a></li>
                <li><a href="navigation.html" class="nav-link">NAVIGATOR</a></li>
                <li><a href="3d-view.html" class="nav-link">WAR ROOM</a></li>
                <li><a href="prediction.html" class="nav-link active">AI SCAN</a></li>
                <li><a href="zones.html" class="nav-link">ZONES</a></li>
                <li><a href="alerts.html" class="nav-link">ALERTS</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <section class="page-header reveal-staggered">
            <h1 class="page-title">
                MULTI-MODAL SCAN
                <span class="gradient-text"
                    style="background: var(--gradient-signal); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">AI
                    ANALYSIS CENTER</span>
            </h1>
            <p class="page-subtitle"
                style="font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; color: var(--text-secondary);">
                [PROTOCOL: TARGETED_SURVEILLANCE] ‚Ä¢ [DATASET: NASA_EONET_GIBBS]
            </p>
        </section>

        <!-- AI Command Center Layout -->
        <div class="prediction-layout">
            <!-- Sidebar: Global History -->
            <aside class="prediction-sidebar">
                <div class="sidebar-header">
                    <h3>üìú AI Output History</h3>
                    <p>Recent Strategic Scans</p>
                </div>
                <div id="historicalPredictionsList" class="history-list">
                    <!-- Populated by JS -->
                    <div class="history-item loading">Loading AI Archives...</div>
                </div>
            </aside>

            <!-- Main Analysis Area -->
            <div class="analysis-main">
                <!-- Input Section -->
                <section class="prediction-input">
                    <div class="input-card">
                        <div
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                            <h2>üåç Targeted Strategic Scan</h2>
                            <div class="ai-status-pill">
                                <span class="pulse-dot"></span>
                                RF-Ensemble Active
                            </div>
                        </div>

                        <!-- üîç Google Maps Style Search -->
                        <div class="search-section" style="margin-bottom: 20px;">
                            <div class="search-box" style="position: relative;">
                                <div
                                    style="display: flex; align-items: center; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 5px;">
                                    <span style="padding: 0 12px; font-size: 18px;">üîç</span>
                                    <input type="text" id="predictionSearchInput"
                                        placeholder="Search any location... Cuttack, Dasapalla, remote areas..."
                                        style="flex: 1; padding: 12px 10px; background: transparent; border: none; color: white; font-size: 15px; outline: none;"
                                        autocomplete="off" onkeyup="handlePredictionSearch(event)">
                                    <button onclick="usePredictionGPS()" title="Use my current location"
                                        style="padding: 8px 12px; background: linear-gradient(135deg, #667eea, #764ba2); border: none; border-radius: 10px; color: white; cursor: pointer; display: flex; align-items: center; gap: 5px; font-weight: 600; margin-right: 5px;">
                                        üìç GPS
                                    </button>
                                </div>

                                <!-- Autocomplete Dropdown -->
                                <div id="predictionSuggestions"
                                    style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: rgba(19, 24, 37, 0.98); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; margin-top: 5px; max-height: 250px; overflow-y: auto; z-index: 100; box-shadow: 0 8px 32px rgba(0,0,0,0.5);">
                                </div>
                            </div>
                            <small style="color: #6b7a99; display: block; margin-top: 8px; text-align: center;">
                                üí° Works for ANY location worldwide - cities, villages, remote areas
                            </small>
                        </div>

                        <!-- Quick Select - Global Locations -->
                        <div class="quick-select">
                            <small style="color: #a8b3cf; margin-bottom: 8px; display: block;">üåç Quick Select
                                (Global):</small>
                            <div class="location-chips">
                                <button class="chip" onclick="selectLocation(40.7128, -74.0060, 'New York')">üá∫üá∏ New
                                    York</button>
                                <button class="chip" onclick="selectLocation(51.5074, -0.1278, 'London')">üá¨üáß
                                    London</button>
                                <button class="chip" onclick="selectLocation(35.6762, 139.6503, 'Tokyo')">üáØüáµ
                                    Tokyo</button>
                                <button class="chip" onclick="selectLocation(-33.8688, 151.2093, 'Sydney')">üá¶üá∫
                                    Sydney</button>
                                <button class="chip" onclick="selectLocation(19.0760, 72.8777, 'Mumbai')">üáÆüá≥
                                    Mumbai</button>
                                <button class="chip" onclick="selectLocation(-23.5505, -46.6333, 'S√£o Paulo')">üáßüá∑ S√£o
                                    Paulo</button>
                                <button class="chip" onclick="selectLocation(30.0444, 31.2357, 'Cairo')">üá™üá¨
                                    Cairo</button>
                                <button class="chip" onclick="selectLocation(1.3521, 103.8198, 'Singapore')">üá∏üá¨
                                    Singapore</button>
                            </div>
                        </div>

                        <!-- Analyze Button -->
                        <button class="btn-analyze" onclick="runPrediction()">
                            <span class="btn-icon">‚ö°</span>
                            <span>Execute Multi-Modal Analysis</span>
                        </button>

                        <div style="margin-top: 15px; text-align: center;">
                            <a href="#" onclick="toggleManualInput(event)"
                                style="color: #667eea; font-size: 12px; text-decoration: none;">+ Manual Coordinate
                                Entry</a>
                        </div>

                        <div id="manualInput" class="manual-input-zone hidden"
                            style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 20px;">
                            <div class="input-grid">
                                <div class="input-field">
                                    <label>Latitude</label>
                                    <input type="number" id="latitude" placeholder="19.0760" step="0.0001">
                                </div>
                                <div class="input-field">
                                    <label>Longitude</label>
                                    <input type="number" id="longitude" placeholder="72.8777" step="0.0001">
                                </div>
                                <div class="input-field">
                                    <label>Location Name</label>
                                    <input type="text" id="locationName" placeholder="Custom Target">
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Loading State -->
                <div id="loading" class="loading-container hidden">
                    <div class="loading-spinner"></div>
                    <h3>AI Neural Processing...</h3>
                    <div class="loading-steps">
                        <div class="step active"><span>üõ∞Ô∏è Fetching NASA Imagery</span></div>
                        <div class="step"><span>üå°Ô∏è Atmospheric Profiling</span></div>
                        <div class="step"><span>üß† Running RF-Inference</span></div>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="results" class="results-section hidden">
                    <!-- AI Neural Log (The "Brain Output" for testers) -->
                    <div class="neural-log-box">
                        <div class="log-header">
                            <span>>_ AI_NEURAL_LOG</span>
                            <span id="logStatus">INFRENECE_COMPLETE</span>
                        </div>
                        <div id="neuralLogOutput" class="log-lines">
                            <!-- Populated line by line by JS -->
                        </div>
                    </div>

                    <div class="results-header">
                        <div>
                            <h2 id="resultLocation">Analysis Results</h2>
                            <p id="resultTimestamp" class="timestamp"></p>
                        </div>
                        <button class="btn-export" onclick="exportResults()">üì• Export Intelligence PDF</button>
                    </div>

                    <!-- Primary Threat Banner -->
                    <div id="primaryThreat" class="threat-banner"></div>

                    <!-- Disaster Risk Cards -->
                    <div class="risk-grid">
                        <!-- Fire Risk -->
                        <div class="risk-card-detailed fire-theme">
                            <div class="card-header">
                                <div class="header-left">
                                    <div class="risk-icon">üî•</div>
                                    <h3>Fire Risk Assessment</h3>
                                </div>
                                <div class="risk-badge" id="fireRiskBadge">-</div>
                            </div>

                            <div class="confidence-section">
                                <div class="confidence-label">
                                    <span>Confidence Score</span>
                                    <span id="fireConfidenceNum">-</span>
                                </div>
                                <div class="confidence-bar">
                                    <div class="confidence-fill" id="fireConfidenceFill"></div>
                                </div>
                            </div>

                            <div class="factors-section">
                                <h4>Contributing Factors:</h4>
                                <div id="fireFactors" class="factors-list">
                                    <!-- Populated dynamically -->
                                </div>
                            </div>

                            <div class="contribution-chart">
                                <div class="chart-header">
                                    <h4>Data Source Breakdown</h4>
                                </div>
                                <div class="chart-bars">
                                    <div class="chart-bar">
                                        <div class="bar-label">üõ∞Ô∏è Satellite</div>
                                        <div class="bar-track">
                                            <div class="bar-fill satellite" id="fireSatelliteBar"></div>
                                        </div>
                                        <div class="bar-value" id="fireSatelliteValue">-</div>
                                    </div>
                                    <div class="chart-bar">
                                        <div class="bar-label">üå°Ô∏è Weather</div>
                                        <div class="bar-track">
                                            <div class="bar-fill weather" id="fireWeatherBar"></div>
                                        </div>
                                        <div class="bar-value" id="fireWeatherValue">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Flood Risk -->
                        <div class="risk-card-detailed flood-theme">
                            <div class="card-header">
                                <div class="header-left">
                                    <div class="risk-icon">üåä</div>
                                    <h3>Flood Risk Assessment</h3>
                                </div>
                                <div class="risk-badge" id="floodRiskBadge">-</div>
                            </div>

                            <div class="confidence-section">
                                <div class="confidence-label">
                                    <span>Confidence Score</span>
                                    <span id="floodConfidenceNum">-</span>
                                </div>
                                <div class="confidence-bar">
                                    <div class="confidence-fill" id="floodConfidenceFill"></div>
                                </div>
                            </div>

                            <div class="factors-section">
                                <h4>Contributing Factors:</h4>
                                <div id="floodFactors" class="factors-list">
                                    <!-- Populated dynamically -->
                                </div>
                            </div>

                            <div class="contribution-chart">
                                <div class="chart-header">
                                    <h4>Data Source Breakdown</h4>
                                </div>
                                <div class="chart-bars">
                                    <div class="chart-bar">
                                        <div class="bar-label">üõ∞Ô∏è Satellite</div>
                                        <div class="bar-track">
                                            <div class="bar-fill satellite" id="floodSatelliteBar"></div>
                                        </div>
                                        <div class="bar-value" id="floodSatelliteValue">-</div>
                                    </div>
                                    <div class="chart-bar">
                                        <div class="bar-label">üå°Ô∏è Weather</div>
                                        <div class="bar-track">
                                            <div class="bar-fill weather" id="floodWeatherBar"></div>
                                        </div>
                                        <div class="bar-value" id="floodWeatherValue">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cyclone Risk -->
                        <div class="risk-card-detailed cyclone-theme">
                            <div class="card-header">
                                <div class="header-left">
                                    <div class="risk-icon">üå™Ô∏è</div>
                                    <h3>Cyclone Risk Assessment</h3>
                                </div>
                                <div class="risk-badge" id="cycloneRiskBadge">-</div>
                            </div>

                            <div class="confidence-section">
                                <div class="confidence-label">
                                    <span>Confidence Score</span>
                                    <span id="cycloneConfidenceNum">-</span>
                                </div>
                                <div class="confidence-bar">
                                    <div class="confidence-fill" id="cycloneConfidenceFill"></div>
                                </div>
                            </div>

                            <div class="factors-section">
                                <h4>Contributing Factors:</h4>
                                <div id="cycloneFactors" class="factors-list">
                                    <!-- Populated dynamically -->
                                </div>
                            </div>

                            <div class="contribution-chart">
                                <div class="chart-header">
                                    <h4>Data Source Breakdown</h4>
                                </div>
                                <div class="chart-bars">
                                    <div class="chart-bar">
                                        <div class="bar-label">üõ∞Ô∏è Satellite</div>
                                        <div class="bar-track">
                                            <div class="bar-fill satellite" id="cycloneSatelliteBar"></div>
                                        </div>
                                        <div class="bar-value" id="cycloneSatelliteValue">-</div>
                                    </div>
                                    <div class="chart-bar">
                                        <div class="bar-label">üå°Ô∏è Weather</div>
                                        <div class="bar-track">
                                            <div class="bar-fill weather" id="cycloneWeatherBar"></div>
                                        </div>
                                        <div class="bar-value" id="cycloneWeatherValue">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Weather Details -->
                    <div class="weather-details">
                        <h3>üå°Ô∏è Current Weather Conditions</h3>
                        <div class="weather-grid" id="weatherGrid">
                            <!-- Skeletons while loading -->
                            <div class="skeleton skeleton-card"></div>
                            <div class="skeleton skeleton-card"></div>
                            <div class="skeleton skeleton-card"></div>
                            <div class="skeleton skeleton-card"></div>
                        </div>
                    </div> <!-- End results -->
                    </section> <!-- End prediction-input -->
                </div> <!-- End analysis-main -->
            </div> <!-- End prediction-layout -->
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>SDARS - AI-Based Satellite-Driven Smart Disaster Alert and Rescue System</p>
        <p>Powered by Multi-Modal AI | 48 Features Analyzed</p>
    </footer>

    <script src="js/main.js"></script>
    <script src="js/prediction.js"></script>
</body>

</html>